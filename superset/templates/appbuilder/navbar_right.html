{% set app_switcher_icon = appbuilder.app.config.get('APP_SWITCHER_ICON') %}
{% set app_switcher = appbuilder.app.config.get('APP_SWITCHER') %}
{% set newWindowIcon = appbuilder.app.config.get('NEW_WINDOW_ICON') %}

<li id="app-switcher" class="icon" style="width: 50px; float: left;">
  <a class="dropdown-toggle" data-toggle="dropdown">
    <img src="{{ app_switcher_icon }}" alt="{{ appbuilder.app_name }}" />
  </a>
  <ul class="dropdown-menu" role="menu">
    <div class="arrow-up"></div>
    <div class="container">
      <table class="dropdown">
        {% for apps in app_switcher.apps %}
        <tr>
          {% for app in apps %}
          <td class="dataCell">
            <div class="innerCellNormal" title="{{app.get('tooltip')}}">
              <div class="itemIcon">
                <img src="{{ newWindowIcon }}"/>
              </div>
              <div class="cellitem">
                <img src="{{app.get('image')}}" class="cellImage"/><br>
              </div>
              <label class="itemLabel">{{app.get('description')}}</label>
            </div>
          </td>
          {% endfor %}
        </tr>
        {% endfor %}
      </table>
      <div class="footer">
        <label class="footerLabel"><i>{{ appbuilder.app_name }}</i></label>
      </div>
    </div>
  </ul>
</li>


{% set locale = session['locale'] %}
{% if not locale %}
    {% set locale = 'en' %}
{% endif %}
{% if languages.keys()|length > 1 %}
<li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown" href="javascript:void(0)">
       <div class="f16"><i class="flag {{languages[locale].get('flag')}}"></i>&nbsp;<b class="caret"></b>
       </div>
    </a>
    <ul class="dropdown-menu" id="language-picker">
      <li class="dropdown">
        {% for lang in languages %}
            {% if lang != locale %}
                <a tabindex="-1" href="{{appbuilder.get_url_for_locale(lang)}}">
                  <div class="f16">
                    <i class="flag {{languages[lang].get('flag')}}"></i> - {{languages[lang].get('name')}}
                  </div>
                </a>
            {% endif %}
        {% endfor %}
      </li>
    </ul>
</li>
{% endif %}



{% if not current_user.is_anonymous() %}
    <li class="dropdown">
      <a
        class="dropdown-toggle"
        data-toggle="dropdown"
        title="{{g.user.get_full_name()}}"
        href="javascript:void(0)"
      >
        <i class="fa fa-user"></i>&nbsp;<b class="caret"></b>
      </a>
        <ul class="dropdown-menu">
            <li><a href="{{appbuilder.get_url_for_userinfo}}"><span class="fa fa-fw fa-user"></span>{{_("Profile")}}</a></li>
            <li><a href="{{appbuilder.get_url_for_logout}}"><span class="fa fa-fw fa-sign-out"></span>{{_("Logout")}}</a></li>
        </ul>
    </li>
{% else %}
    <li><a href="{{appbuilder.get_url_for_login}}">
    <i class="fa fa-fw fa-sign-in"></i>{{_("Login")}}</a></li>
{% endif %}
